<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Search - Unit 1 Animal Friends</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Fredoka', cursive;
            background: linear-gradient(135deg, #56CCF2 0%, #2F80ED 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .game-container {
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            max-width: 1200px;
            width: 100%;
        }
        
        .game-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .word-list-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            max-width: 300px;
        }
        
        .panel-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
        }
        
        .words-to-find {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .word-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .word-tag.found {
            background: #e8f5e8;
            color: #2e7d32;
            text-decoration: line-through;
            opacity: 0.6;
        }
        
        .timer-display {
            font-size: 2rem;
            font-weight: 700;
            color: #ff6b6b;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .difficulty-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .difficulty-btn {
            background: #e0e0e0;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .difficulty-btn.active {
            background: linear-gradient(45deg, #56CCF2, #2F80ED);
            color: white;
            transform: scale(1.05);
        }
        
        .search-grid-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .search-grid {
            display: grid;
            grid-template-columns: repeat(15, 1fr);
            grid-template-rows: repeat(12, 1fr);
            gap: 2px;
            background: #e0e0e0;
            padding: 10px;
            border-radius: 15px;
            user-select: none;
            cursor: crosshair;
            max-width: 900px;
            width: 100%;
        }
        
        .grid-cell {
            aspect-ratio: 1;
            background: white;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .grid-cell:hover {
            background: #f0f0f0;
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .grid-cell.selected {
            background: #ffeb3b;
            color: #333;
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(255,235,59,0.4);
        }
        
        .grid-cell.found {
            background: #4CAF50;
            color: white;
            animation: foundPulse 0.6s ease;
        }
        
        @keyframes foundPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .selection-mode {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .mode-btn {
            background: white;
            border: 2px solid #56CCF2;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-btn.active {
            background: #56CCF2;
            color: white;
            transform: scale(1.05);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76,175,80,0.4);
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(76,175,80,0.6);
        }
        
        .btn.secondary {
            background: linear-gradient(45deg, #ff9800, #f57c00);
        }
        
        .btn.danger {
            background: linear-gradient(45deg, #f44336, #da190b);
        }
        
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #56CCF2;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        .message {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #bee5eb;
        }
        
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        .current-word {
            background: #ff6b6b;
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            text-align: center;
            margin-bottom: 20px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .instructions {
            background: #e8f0fe;
            border: 2px solid #56CCF2;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .instructions ul {
            color: #1976d2;
            font-size: 1rem;
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            
            .game-controls {
                flex-direction: column;
            }
            
            .search-grid {
                grid-template-columns: repeat(12, 1fr);
                grid-template-rows: repeat(10, 1fr);
            }
            
            .grid-cell {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="location.href='index.html'">‚Üê Back to Home</button>
    
    <header>
        <h1>ü¶Å Word Search - Unit 1 Animal Friends</h1>
        <p>Find hidden animal words in the letter grid!<br><span style="font-size: 1.2rem;">ÂçïËØçÊêúÁ¥¢Ê∏∏Êàè</span></p>
    </header>
    
    <main class="game-container">
        <div class="stats-panel">
            <div class="stat-item">
                <div class="stat-value" id="words-found">0</div>
                <div class="stat-label">Words Found<br><span style="font-size: 0.8rem;">ÊâæÂà∞ÂçïËØç</span></div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="total-words">0</div>
                <div class="stat-label">Total Words<br><span style="font-size: 0.8rem;">ÊÄªÂçïËØçÊï∞</span></div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="time-elapsed">0:00</div>
                <div class="stat-label">Time<br><span style="font-size: 0.8rem;">Êó∂Èó¥</span></div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="score">0</div>
                <div class="stat-label">Score<br><span style="font-size: 0.8rem;">ÂàÜÊï∞</span></div>
            </div>
        </div>
        
        <div id="message"></div>
        
        <div class="game-controls">
            <div class="word-list-panel">
                <div class="panel-title">üìã Animals to Find<br><span style="font-size: 1rem;">ÂæÖÊâæÂä®Áâ©</span></div>
                <div class="words-to-find" id="words-to-find">
                    <!-- Word tags will be added here -->
                </div>
                <div class="timer-display" id="timer">‚è±Ô∏è Ready</div>
                
                <div class="difficulty-selector">
                    <button class="difficulty-btn active" onclick="setDifficulty('easy')">Easy</button>
                    <button class="difficulty-btn" onclick="setDifficulty('medium')">Medium</button>
                    <button class="difficulty-btn" onclick="setDifficulty('hard')">Hard</button>
                </div>
            </div>
            
            <div class="search-grid-container">
                <div class="selection-mode">
                    <button class="mode-btn active" onclick="setSelectionMode('click')">Click Mode</button>
                    <button class="mode-btn" onclick="setSelectionMode('drag')">Drag Mode</button>
                </div>
                
                <div class="current-word" id="current-word">
                    Click "New Game" to start!
                </div>
                
                <div class="search-grid" id="search-grid">
                    <!-- Grid cells will be generated here -->
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="newGame()">
                üéÆ New Game<br><span style="font-size: 0.9rem;">Êñ∞Ê∏∏Êàè</span>
            </button>
            <button class="btn secondary" onclick="showHint()">
                üí° Hint<br><span style="font-size: 0.9rem;">ÊèêÁ§∫</span>
            </button>
            <button class="btn secondary" onclick="checkAnswers()">
                ‚úÖ Check Answers<br><span style="font-size: 0.9rem;">Ê£ÄÊü•Á≠îÊ°à</span>
            </button>
            <button class="btn danger" onclick="revealAll()">
                üëÄ Reveal All<br><span style="font-size: 0.9rem;">ÊòæÁ§∫ÂÖ®ÈÉ®</span>
            </button>
        </div>
        
        <div class="instructions">
            <h3>üìã How to Play / Ê∏∏ÊàèËßÑÂàô</h3>
            <ul>
                <li>Find all hidden animal words from the list<br>ÊâæÂá∫ÂàóË°®‰∏≠ÊâÄÊúâÈöêËóèÁöÑÂä®Áâ©ÂçïËØç</li>
                <li>Words can be horizontal, vertical, or diagonal<br>ÂçïËØçÂèØ‰ª•ÊòØÊ∞¥Âπ≥„ÄÅÂûÇÁõ¥ÊàñÂØπËßíÁ∫ø</li>
                <li>Click or drag to select words<br>ÁÇπÂáªÊàñÊãñÂä®ÈÄâÊã©ÂçïËØç</li>
                <li>Words are case-insensitive<br>ÂçïËØç‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô</li>
                <li>Faster completion = higher score<br>ÂÆåÊàêË∂äÂø´ÂæóÂàÜË∂äÈ´ò</li>
            </ul>
        </div>
    </main>
    
    <script>
        // Animal vocabulary with Chinese translations
        const animalVocabulary = [
            { word: 'lion', chinese: 'ÁãÆÂ≠ê' },
            { word: 'tiger', chinese: 'ËÄÅËôé' },
            { word: 'bear', chinese: 'ÁÜä' },
            { word: 'wolf', chinese: 'Áãº' },
            { word: 'fox', chinese: 'ÁãêÁã∏' },
            { word: 'eagle', chinese: 'Èπ∞' },
            { word: 'snake', chinese: 'Ëõá' },
            { word: 'monkey', chinese: 'Áå¥Â≠ê' },
            { word: 'elephant', chinese: 'Â§ßË±°' },
            { word: 'penguin', chinese: '‰ºÅÈπÖ' },
            { word: 'shark', chinese: 'È≤®È±º' },
            { word: 'whale', chinese: 'È≤∏È±º' }
        ];
        
        // Game state
        let currentDifficulty = 'easy';
        let currentWords = [];
        let foundWords = [];
        let grid = [];
        let gridSize = { rows: 12, cols: 15 };
        let selectionMode = 'click';
        let isSelecting = false;
        let selectedCells = [];
        let startTime = null;
        let timerInterval = null;
        let score = 0;
        
        function setDifficulty(difficulty) {
            currentDifficulty = difficulty;
            
            // Update button states
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Adjust grid size based on difficulty
            switch (difficulty) {
                case 'easy':
                    gridSize = { rows: 12, cols: 15 };
                    break;
                case 'medium':
                    gridSize = { rows: 12, cols: 15 };
                    break;
                case 'hard':
                    gridSize = { rows: 15, cols: 18 };
                    break;
            }
            
            if (!grid[0] || grid[0].length === 0) {
                newGame();
            }
        }
        
        function setSelectionMode(mode) {
            selectionMode = mode;
            
            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        function newGame() {
            // Select words based on difficulty
            let wordCount;
            switch (currentDifficulty) {
                case 'easy':
                    wordCount = 6;
                    break;
                case 'medium':
                    wordCount = 9;
                    break;
                case 'hard':
                    wordCount = 12;
                    break;
            }
            
            // Shuffle and select words
            const shuffled = [...animalVocabulary].sort(() => Math.random() - 0.5);
            currentWords = shuffled.slice(0, wordCount);
            
            foundWords = [];
            score = 0;
            startTime = Date.now();
            
            // Create grid and place words
            createGrid();
            placeWords();
            
            // Fill empty cells with random letters
            fillEmptyCells();
            
            // Render grid
            renderGrid();
            
            // Update word list
            updateWordList();
            
            // Start timer
            startTimer();
            
            // Update stats
            updateStats();
            
            showMessage('üéÆ New game started! Find all hidden animal words!', 'info');
        }
        
        function createGrid() {
            grid = [];
            for (let i = 0; i < gridSize.rows; i++) {
                grid[i] = [];
                for (let j = 0; j < gridSize.cols; j++) {
                    grid[i][j] = '';
                }
            }
        }
        
        function placeWords() {
            const directions = [
                { dx: 0, dy: 1 },   // horizontal
                { dx: 1, dy: 0 },   // vertical
                { dx: 1, dy: 1 },   // diagonal down-right
                { dx: -1, dy: 1 },  // diagonal down-left
                { dx: 0, dy: -1 },  // horizontal reversed
                { dx: 1, dy: -1 },  // vertical reversed
                { dx: -1, dy: -1 }, // diagonal up-left
                { dx: 1, dy: -1 }   // diagonal up-right
            ];
            
            for (const wordData of currentWords) {
                let placed = false;
                let attempts = 0;
                
                while (!placed && attempts < 100) {
                    const direction = directions[Math.floor(Math.random() * directions.length)];
                    const word = wordData.word.toUpperCase();
                    
                    const startRow = Math.floor(Math.random() * gridSize.rows);
                    const startCol = Math.floor(Math.random() * gridSize.cols);
                    
                    const endRow = startRow + direction.dy * (word.length - 1);
                    const endCol = startCol + direction.dx * (word.length - 1);
                    
                    // Check if word fits
                    if (endRow >= 0 && endRow < gridSize.rows && 
                        endCol >= 0 && endCol < gridSize.cols) {
                        
                        let canPlace = true;
                        for (let i = 0; i < word.length; i++) {
                            const row = startRow + direction.dy * i;
                            const col = startCol + direction.dx * i;
                            
                            if (grid[row][col] !== '' && grid[row][col] !== word[i]) {
                                canPlace = false;
                                break;
                            }
                        }
                        
                        if (canPlace) {
                            // Place the word
                            for (let i = 0; i < word.length; i++) {
                                const row = startRow + direction.dy * i;
                                const col = startCol + direction.dx * i;
                                grid[row][col] = word[i];
                            }
                            placed = true;
                        }
                    }
                    
                    attempts++;
                }
            }
        }
        
        function fillEmptyCells() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            for (let i = 0; i < gridSize.rows; i++) {
                for (let j = 0; j < gridSize.cols; j++) {
                    if (grid[i][j] === '') {
                        grid[i][j] = letters[Math.floor(Math.random() * letters.length)];
                    }
                }
            }
        }
        
        function renderGrid() {
            const container = document.getElementById('search-grid');
            container.innerHTML = '';
            
            // Update grid size
            container.style.gridTemplateColumns = `repeat(${gridSize.cols}, 1fr)`;
            container.style.gridTemplateRows = `repeat(${gridSize.rows}, 1fr)`;
            
            for (let i = 0; i < gridSize.rows; i++) {
                for (let j = 0; j < gridSize.cols; j++) {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell';
                    cell.textContent = grid[i][j];
                    cell.dataset.row = i;
                    cell.dataset.col = j;
                    
                    // Mouse events for click mode
                    if (selectionMode === 'click') {
                        cell.addEventListener('mousedown', handleCellMouseDown);
                        cell.addEventListener('mouseenter', handleCellMouseEnter);
                        cell.addEventListener('mouseup', handleCellMouseUp);
                    }
                    
                    container.appendChild(cell);
                }
            }
            
            // Global mouse up for click mode
            document.addEventListener('mouseup', handleGlobalMouseUp);
        }
        
        function handleCellMouseDown(e) {
            if (selectionMode !== 'click') return;
            
            isSelecting = true;
            selectedCells = [];
            selectCell(e.target);
        }
        
        function handleCellMouseEnter(e) {
            if (selectionMode !== 'click' || !isSelecting) return;
            
            const cell = e.target;
            if (!selectedCells.includes(cell)) {
                selectCell(cell);
            }
        }
        
        function handleCellMouseUp(e) {
            if (selectionMode !== 'click') return;
            
            if (isSelecting) {
                checkSelection();
                isSelecting = false;
            }
        }
        
        function handleGlobalMouseUp(e) {
            if (selectionMode === 'click' && isSelecting) {
                isSelecting = false;
            }
        }
        
        function selectCell(cell) {
            cell.classList.add('selected');
            selectedCells.push(cell);
        }
        
        function checkSelection() {
            if (selectedCells.length < 2) return;
            
            const selectedWord = selectedCells.map(cell => cell.textContent).join('');
            
            // Check if this matches any word
            for (const wordData of currentWords) {
                if (wordData.word.toUpperCase() === selectedWord || 
                    wordData.word.toUpperCase() === selectedWord.split('').reverse().join('')) {
                    
                    // Word found!
                    foundWords.push(wordData.word);
                    score += calculateScore(wordData.word.length);
                    
                    // Mark cells as found
                    selectedCells.forEach(cell => {
                        cell.classList.remove('selected');
                        cell.classList.add('found');
                    });
                    
                    // Update word list
                    updateWordList();
                    
                    // Update stats
                    updateStats();
                    
                    // Check if all words found
                    if (foundWords.length === currentWords.length) {
                        gameComplete();
                    } else {
                        showMessage(`üéâ Found "${wordData.word}" (${wordData.chinese})! +${calculateScore(wordData.word.length)} points`, 'success');
                    }
                    
                    break;
                }
            }
            
            selectedCells = [];
        }
        
        function calculateScore(wordLength) {
            let baseScore = wordLength * 10;
            const timeBonus = Math.max(0, 300 - (Date.now() - startTime) / 1000);
            return Math.round(baseScore + timeBonus);
        }
        
        function updateWordList() {
            const container = document.getElementById('words-to-find');
            container.innerHTML = '';
            
            currentWords.forEach(wordData => {
                const tag = document.createElement('div');
                tag.className = 'word-tag' + (foundWords.includes(wordData.word) ? ' found' : '');
                tag.textContent = `${wordData.word} (${wordData.chinese})`;
                container.appendChild(tag);
            });
        }
        
        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (!startTime) return;
                
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                
                const timeStr = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                document.getElementById('timer').textContent = `‚è±Ô∏è ${timeStr}`;
                document.getElementById('time-elapsed').textContent = timeStr;
            }, 1000);
        }
        
        function updateStats() {
            document.getElementById('words-found').textContent = foundWords.length;
            document.getElementById('total-words').textContent = currentWords.length;
            document.getElementById('score').textContent = score;
            
            // Update progress
            const progress = (foundWords.length / currentWords.length) * 100;
            document.getElementById('current-word').textContent = `Progress: ${Math.round(progress)}%`;
        }
        
        function showHint() {
            // Find an unfound word and highlight its first letter
            const unfoundWords = currentWords.filter(w => !foundWords.includes(w.word));
            
            if (unfoundWords.length > 0) {
                const hintWord = unfoundWords[0].word.toUpperCase();
                const firstLetter = hintWord[0];
                
                // Find and highlight the first letter
                const cells = document.querySelectorAll('.grid-cell');
                for (const cell of cells) {
                    if (cell.textContent === firstLetter) {
                        cell.style.background = '#ffeb3b';
                        setTimeout(() => {
                            cell.style.background = '';
                        }, 3000);
                        break;
                    }
                }
                
                showMessage(`üí° Hint: Look for "${unfoundWords[0].word}" (${unfoundWords[0].chinese}) starting with "${firstLetter}"`, 'info');
                
                // Deduct points for hint
                score = Math.max(0, score - 50);
                updateStats();
            } else {
                showMessage('üí° No hints available - all words found!', 'info');
            }
        }
        
        function checkAnswers() {
            // Highlight all found words and show any missed
            const cells = document.querySelectorAll('.grid-cell');
            let allFound = true;
            
            currentWords.forEach(wordData => {
                const word = wordData.word.toUpperCase();
                let found = foundWords.includes(wordData.word);
                
                if (!found) {
                    allFound = false;
                    // Try to find the word in grid
                    for (let i = 0; i < gridSize.rows; i++) {
                        for (let j = 0; j < gridSize.cols; j++) {
                            if (grid[i][j] === word[0]) {
                                // Check if word starts here
                                const directions = [
                                    { dx: 0, dy: 1 },
                                    { dx: 1, dy: 0 },
                                    { dx: 1, dy: 1 },
                                    { dx: -1, dy: 1 }
                                ];
                                
                                for (const dir of directions) {
                                    let matches = true;
                                    for (let k = 0; k < word.length; k++) {
                                        const row = i + dir.dy * k;
                                        const col = j + dir.dx * k;
                                        
                                        if (row < 0 || row >= gridSize.rows || 
                                            col < 0 || col >= gridSize.cols ||
                                            grid[row][col] !== word[k]) {
                                            matches = false;
                                            break;
                                        }
                                    }
                                    
                                    if (matches) {
                                        foundWords.push(wordData.word);
                                        // Highlight the word
                                        for (let k = 0; k < word.length; k++) {
                                            const row = i + dir.dy * k;
                                            const col = j + dir.dx * k;
                                            const cell = cells[row * gridSize.cols + col];
                                            cell.classList.add('found');
                                        }
                                        updateWordList();
                                        updateStats();
                                        break;
                                    }
                                }
                                
                                if (found) break;
                            }
                        }
                        
                        if (found) break;
                    }
                }
            });
            
            if (allFound) {
                showMessage('üéâ All words found!', 'success');
                gameComplete();
            } else {
                showMessage('‚úÖ Words checked. Any missed words have been highlighted.', 'info');
            }
        }
        
        function revealAll() {
            if (confirm('Reveal all words? This will end the current game.')) {
                // Mark all words as found
                currentWords.forEach(wordData => {
                    if (!foundWords.includes(wordData.word)) {
                        foundWords.push(wordData.word);
                    }
                });
                
                // Highlight all word cells
                const cells = document.querySelectorAll('.grid-cell');
                cells.forEach(cell => {
                    cell.classList.add('found');
                });
                
                updateWordList();
                updateStats();
                gameComplete();
            }
        }
        
        function gameComplete() {
            clearInterval(timerInterval);
            const totalTime = Math.floor((Date.now() - startTime) / 1000);
            
            showMessage(`üéâ Congratulations! All ${currentWords.length} animal words found in ${totalTime} seconds! Final score: ${score}`, 'success');
            
            // Save stats
            updateUnitStats();
        }
        
        function updateUnitStats() {
            const stats = JSON.parse(localStorage.getItem('unit1-stats') || '{}');
            stats.gamesPlayed = (stats.gamesPlayed || 0) + 1;
            stats.totalScore = (stats.totalScore || 0) + score;
            stats.bestScore = Math.max(stats.bestScore || 0, score);
            stats.totalAttempts = (stats.totalAttempts || 0) + 1;
            stats.correctAnswers = (stats.correctAnswers || 0) + foundWords.length;
            localStorage.setItem('unit1-stats', JSON.stringify(stats));
        }
        
        function showMessage(text, type) {
            const messageContainer = document.getElementById('message');
            messageContainer.innerHTML = `<div class="message ${type}">${text}</div>`;
            
            setTimeout(() => {
                messageContainer.innerHTML = '';
            }, 3000);
        }
        
        // Initialize game
        function initGame() {
            newGame();
        }
        
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>