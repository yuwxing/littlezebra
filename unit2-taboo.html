<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taboo Game - Unit 2 Vocabulary</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Fredoka', cursive;
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .game-container {
            background: white;
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            max-width: 1200px;
            width: 100%;
        }
        
        .game-layout {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .team-panel {
            background: #f8f9fa;
            border-radius: 20px;
            padding: 25px;
            text-align: center;
        }
        
        .team-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }
        
        .team-score {
            font-size: 3rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .team-members {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .member-name {
            padding: 8px;
            margin-bottom: 5px;
            background: #e8f0fe;
            border-radius: 8px;
            font-weight: 600;
            color: #333;
        }
        
        .word-display {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            color: white;
            padding: 40px;
            border-radius: 20px;
            font-size: 3rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(255,107,107,0.4);
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .word-english {
            margin-bottom: 10px;
        }
        
        .word-chinese {
            font-size: 1.5rem;
            opacity: 0.9;
        }
        
        .forbidden-words {
            background: #ffebee;
            border: 3px solid #f44336;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
        }
        
        .forbidden-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #d32f2f;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .forbidden-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .forbidden-word {
            background: white;
            color: #d32f2f;
            padding: 12px;
            border-radius: 10px;
            font-weight: 600;
            text-align: center;
            border: 2px solid #ffcdd2;
            position: relative;
        }
        
        .forbidden-word::after {
            content: 'âŒ';
            position: absolute;
            top: -5px;
            right: -5px;
            background: #d32f2f;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        .timer-section {
            background: #e3f2fd;
            border: 3px solid #2196f3;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .timer-display {
            font-size: 3rem;
            font-weight: 700;
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .timer-bar {
            width: 100%;
            height: 10px;
            background: #bbdefb;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .timer-fill {
            height: 100%;
            background: linear-gradient(45deg, #2196f3, #1976d2);
            transition: width 1s linear;
            border-radius: 5px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76,175,80,0.4);
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(76,175,80,0.6);
        }
        
        .btn.secondary {
            background: linear-gradient(45deg, #ff9800, #f57c00);
        }
        
        .btn.danger {
            background: linear-gradient(45deg, #f44336, #da190b);
        }
        
        .btn.warning {
            background: linear-gradient(45deg, #ff5722, #e64a19);
        }
        
        .message {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .message.warning {
            background: #fff3cd;
            color: #856404;
            border: 2px solid #ffeaa7;
        }
        
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        .round-indicator {
            background: #f3e5f5;
            border: 3px solid #9c27b0;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .round-number {
            font-size: 2rem;
            font-weight: 700;
            color: #7b1fa2;
            margin-bottom: 5px;
        }
        
        .current-team {
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 600;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .score-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .score-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }
        
        .score-value {
            font-size: 2rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .score-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        .penalty-display {
            background: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            margin-top: 15px;
        }
        
        .penalty-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: #e65100;
        }
        
        .instructions {
            background: #e8f5e8;
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #2e7d32;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .instructions ul {
            color: #2e7d32;
            font-size: 1rem;
            padding-left: 20px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        @media (max-width: 768px) {
            .game-layout {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .word-display {
                font-size: 2rem;
            }
            
            .forbidden-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="location.href='unit2-master.html'">â† Back to Unit 2</button>
    
    <header>
        <h1>ğŸš« Taboo Game</h1>
        <p>Describe words without using forbidden words!<br><span style="font-size: 1.2rem;">ç¦è¯æè¿°æ¸¸æˆ</span></p>
    </header>
    
    <main class="game-container">
        <div class="score-panel">
            <div class="score-item">
                <div class="score-value" id="round-count">1</div>
                <div class="score-label">Round<br><span style="font-size: 0.8rem;">å›åˆ</span></div>
            </div>
            <div class="score-item">
                <div class="score-value" id="team1-score">0</div>
                <div class="score-label">Team 1<br><span style="font-size: 0.8rem;">1é˜Ÿ</span></div>
            </div>
            <div class="score-item">
                <div class="score-value" id="team2-score">0</div>
                <div class="score-label">Team 2<br><span style="font-size: 0.8rem;">2é˜Ÿ</span></div>
            </div>
            <div class="score-item">
                <div class="score-value" id="penalties">0</div>
                <div class="score-label">Penalties<br><span style="font-size: 0.8rem;">ç½šåˆ†</span></div>
            </div>
        </div>
        
        <div id="message"></div>
        
        <div class="game-layout">
            <div class="team-panel">
                <div class="team-title">ğŸ  Team 1<br><span style="font-size: 1rem;">1é˜Ÿ</span></div>
                <div class="team-score" id="team1-display">0</div>
                <div class="team-members" id="team1-members">
                    <div class="member-name">Player 1</div>
                    <div class="member-name">Player 2</div>
                </div>
                
                <div class="penalty-display">
                    <div class="penalty-text">Penalties: <span id="team1-penalties">0</span></div>
                </div>
            </div>
            
            <div class="game-area">
                <div class="round-indicator">
                    <div class="current-team" id="current-team-display">
                        Team 1's Turn<br><span style="font-size: 0.9rem;">1é˜Ÿå›åˆ</span>
                    </div>
                </div>
                
                <div class="word-display" id="word-display">
                    <div class="word-english">Click "Start Round" to begin!</div>
                    <div class="word-chinese">ç‚¹å‡»"å¼€å§‹å›åˆ"å¼€å§‹æ¸¸æˆï¼</div>
                </div>
                
                <div class="forbidden-words" id="forbidden-words" style="display: none;">
                    <div class="forbidden-title">
                        ğŸš« Forbidden Words / ç¦ç”¨è¯æ±‡
                    </div>
                    <div class="forbidden-list" id="forbidden-list">
                        <!-- Forbidden words will be displayed here -->
                    </div>
                </div>
                
                <div class="timer-section">
                    <div class="timer-display" id="timer">60</div>
                    <div class="timer-bar">
                        <div class="timer-fill" id="timer-fill" style="width: 100%"></div>
                    </div>
                </div>
                
                <div class="controls">
                    <button class="btn" id="start-btn" onclick="startRound()">
                        â–¶ï¸ Start Round<br><span style="font-size: 0.9rem;">å¼€å§‹å›åˆ</span>
                    </button>
                    <button class="btn success" id="correct-btn" onclick="correctGuess()" disabled>
                        âœ… Correct<br><span style="font-size: 0.9rem;">æ­£ç¡®</span>
                    </button>
                    <button class="btn warning" id="penalty-btn" onclick="addPenalty()" disabled>
                        âš ï¸ Penalty<br><span style="font-size: 0.9rem;">ç½šåˆ†</span>
                    </button>
                    <button class="btn secondary" onclick="passTurn()">
                        â­ï¸ Pass Turn<br><span style="font-size: 0.9rem;">è½®æ¢</span>
                    </button>
                </div>
                
                <div class="instructions">
                    <h3>ğŸ“‹ Game Rules / æ¸¸æˆè§„åˆ™</h3>
                    <ul>
                        <li>Describe the target word without using forbidden words<br>ä¸ç”¨ç¦ç”¨è¯æè¿°ç›®æ ‡å•è¯</li>
                        <li>Each correct guess earns 10 points<br>æ¯æ¬¡æ­£ç¡®çŒœæµ‹å¾—10åˆ†</li>
                        <li>Using forbidden words = 5 point penalty<br>ä½¿ç”¨ç¦ç”¨è¯æ‰£5åˆ†</li>
                        <li>60 seconds per turn<br>æ¯å›åˆ60ç§’</li>
                        <li>Teams alternate turns<br>é˜Ÿä¼è½®æ¢è¿›è¡Œ</li>
                    </ul>
                </div>
            </div>
            
            <div class="team-panel">
                <div class="team-title">ğŸ¢ Team 2<br><span style="font-size: 1rem;">2é˜Ÿ</span></div>
                <div class="team-score" id="team2-display">0</div>
                <div class="team-members" id="team2-members">
                    <div class="member-name">Player 3</div>
                    <div class="member-name">Player 4</div>
                </div>
                
                <div class="penalty-display">
                    <div class="penalty-text">Penalties: <span id="team2-penalties">0</span></div>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        // Load vocabulary from localStorage
        const vocabulary = JSON.parse(localStorage.getItem('unit2-vocabulary'));
        if (!vocabulary) {
            alert('Please load unit2-master.html first!');
            location.href = 'unit2-master.html';
        }
        
        // Create taboo word mappings
        const tabooMappings = {
            'rule': ['follow', 'order', 'regulation', 'law'],
            'order': ['rule', 'command', 'arrange', 'sequence'],
            'follow': ['rule', 'order', 'behind', 'obey'],
            'late': ['time', 'early', 'delay', 'tardy'],
            'phone': ['call', 'mobile', 'telephone', 'ring'],
            'arrive': ['come', 'reach', 'get', 'destination'],
            'uniform': ['clothes', 'school', 'wear', 'dress'],
            'polite': ['rude', 'nice', 'manners', 'respectful'],
            'respect': ['polite', 'honor', 'admire', 'look up to'],
            'quiet': ['noise', 'loud', 'silent', 'shh'],
            'absent': ['present', 'here', 'missing', 'away'],
            'practice': ['train', 'exercise', 'study', 'rehearse'],
            'focus': ['concentrate', 'attention', 'study', 'think'],
            'relax': ['stress', 'rest', 'calm', 'unwind']
        };
        
        // Game state
        let currentWord = null;
        let currentTeam = 1;
        let roundCount = 1;
        let team1Score = 0;
        let team2Score = 0;
        let team1Penalties = 0;
        let team2Penalties = 0;
        let timeLeft = 60;
        let timerInterval = null;
        let gameActive = false;
        let usedWords = [];
        
        function startRound() {
            // Select random word that hasn't been used
            const availableWords = vocabulary.core.filter(w => !usedWords.includes(w.word));
            
            if (availableWords.length === 0) {
                showMessage('ğŸ‰ All words used! Game Over!', 'success');
                endGame();
                return;
            }
            
            currentWord = availableWords[Math.floor(Math.random()) * availableWords.length];
            usedWords.push(currentWord.word);
            gameActive = true;
            timeLeft = 60;
            
            // Update display
            updateWordDisplay();
            updateForbiddenWords();
            updateTeamDisplay();
            
            // Enable/disable buttons
            document.getElementById('start-btn').disabled = true;
            document.getElementById('correct-btn').disabled = false;
            document.getElementById('penalty-btn').disabled = false;
            
            // Start timer
            startTimer();
            
            showMessage(`ğŸ® Round ${roundCount} started! ${currentTeam === 1 ? 'Team 1' : 'Team 2'} is playing.`, 'success');
        }
        
        function updateWordDisplay() {
            const display = document.getElementById('word-display');
            display.innerHTML = `
                <div class="word-english">${currentWord.word.toUpperCase()}</div>
                <div class="word-chinese">${currentWord.chinese}</div>
                <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">${currentWord.phonetic}</div>
            `;
        }
        
        function updateForbiddenWords() {
            const forbidden = tabooMappings[currentWord.word] || [];
            const container = document.getElementById('forbidden-list');
            
            if (forbidden.length > 0) {
                document.getElementById('forbidden-words').style.display = 'block';
                container.innerHTML = '';
                
                forbidden.forEach(word => {
                    const wordDiv = document.createElement('div');
                    wordDiv.className = 'forbidden-word';
                    wordDiv.textContent = word.toUpperCase();
                    container.appendChild(wordDiv);
                });
            } else {
                // Generate generic forbidden words if no specific mapping
                const genericForbidden = currentWord.word.split(' ').slice(0, 3);
                document.getElementById('forbidden-words').style.display = 'block';
                container.innerHTML = '';
                
                genericForbidden.forEach(word => {
                    if (word.length > 2) {
                        const wordDiv = document.createElement('div');
                        wordDiv.className = 'forbidden-word';
                        wordDiv.textContent = word.toUpperCase();
                        container.appendChild(wordDiv);
                    }
                });
                
                // Add some related words
                const related = ['word', 'say', 'meaning', 'describe'];
                related.forEach(word => {
                    const wordDiv = document.createElement('div');
                    wordDiv.className = 'forbidden-word';
                    wordDiv.textContent = word.toUpperCase();
                    container.appendChild(wordDiv);
                });
            }
        }
        
        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                
                const percentage = (timeLeft / 60) * 100;
                document.getElementById('timer-fill').style.width = percentage + '%';
                
                if (timeLeft <= 10) {
                    document.getElementById('timer').style.color = '#d32f2f';
                } else {
                    document.getElementById('timer').style.color = '#1976d2';
                }
                
                if (timeLeft <= 0) {
                    endTurn();
                }
            }, 1000);
        }
        
        function correctGuess() {
            if (!gameActive) return;
            
            if (currentTeam === 1) {
                team1Score += 10;
            } else {
                team2Score += 10;
            }
            
            showMessage(`ğŸ‰ Correct! ${currentTeam === 1 ? 'Team 1' : 'Team 2'} earns 10 points!`, 'success');
            endTurn();
        }
        
        function addPenalty() {
            if (!gameActive) return;
            
            if (currentTeam === 1) {
                team1Penalties += 5;
                team1Score = Math.max(0, team1Score - 5);
            } else {
                team2Penalties += 5;
                team2Score = Math.max(0, team2Score - 5);
            }
            
            showMessage(`âš ï¸ Penalty! ${currentTeam === 1 ? 'Team 1' : 'Team 2'} loses 5 points for using forbidden word!`, 'warning');
            updateScores();
        }
        
        function passTurn() {
            if (!gameActive) return;
            
            showMessage(`â­ï¸ ${currentTeam === 1 ? 'Team 1' : 'Team 2'} passed their turn.`, 'info');
            endTurn();
        }
        
        function endTurn() {
            gameActive = false;
            clearInterval(timerInterval);
            
            // Switch teams
            currentTeam = currentTeam === 1 ? 2 : 1;
            
            // Reset display
            document.getElementById('word-display').innerHTML = `
                <div class="word-english">Click "Start Round" to continue!</div>
                <div class="word-chinese">ç‚¹å‡»"å¼€å§‹å›åˆ"ç»§ç»­ï¼</div>
            `;
            document.getElementById('forbidden-words').style.display = 'none';
            
            // Reset buttons
            document.getElementById('start-btn').disabled = false;
            document.getElementById('correct-btn').disabled = true;
            document.getElementById('penalty-btn').disabled = true;
            
            // Update displays
            updateTeamDisplay();
            updateScores();
            
            // Check if round is complete
            if (usedWords.length % 2 === 0 && usedWords.length > 0) {
                roundCount++;
                document.getElementById('round-count').textContent = roundCount;
            }
        }
        
        function updateTeamDisplay() {
            const display = document.getElementById('current-team-display');
            display.innerHTML = `${currentTeam === 1 ? 'Team 1' : 'Team 2'}'s Turn<br><span style="font-size: 0.9rem;">${currentTeam === 1 ? '1é˜Ÿ' : '2é˜Ÿ'}å›åˆ</span>`;
        }
        
        function updateScores() {
            document.getElementById('team1-score').textContent = team1Score;
            document.getElementById('team2-score').textContent = team2Score;
            document.getElementById('team1-display').textContent = team1Score;
            document.getElementById('team2-display').textContent = team2Score;
            document.getElementById('team1-penalties').textContent = team1Penalties;
            document.getElementById('team2-penalties').textContent = team2Penalties;
            document.getElementById('penalties').textContent = team1Penalties + team2Penalties;
        }
        
        function endGame() {
            clearInterval(timerInterval);
            gameActive = false;
            
            const winner = team1Score > team2Score ? 'Team 1' : team2Score === team1Score ? 'Tie' : 'Team 2';
            const winnerCN = team1Score > team2Score ? '1é˜Ÿ' : team2Score === team1Score ? 'å¹³å±€' : '2é˜Ÿ';
            
            showMessage(`ğŸ† Game Over! Winner: ${winner} (${winnerCN})!`, 'success');
            
            // Save stats
            updateUnitStats();
        }
        
        function updateUnitStats() {
            const stats = JSON.parse(localStorage.getItem('unit2-stats') || '{}');
            stats.gamesPlayed = (stats.gamesPlayed || 0) + 1;
            stats.totalScore = (stats.totalScore || 0) + Math.max(team1Score, team2Score);
            stats.bestScore = Math.max(stats.bestScore || 0, Math.max(team1Score, team2Score));
            stats.totalAttempts = (stats.totalAttempts || 0) + 1;
            stats.correctAnswers = (stats.correctAnswers || 0) + 1;
            localStorage.setItem('unit2-stats', JSON.stringify(stats));
        }
        
        function showMessage(text, type) {
            const messageContainer = document.getElementById('message');
            messageContainer.innerHTML = `<div class="message ${type}">${text}</div>`;
            
            setTimeout(() => {
                messageContainer.innerHTML = '';
            }, 3000);
        }
        
        // Initialize game
        function initGame() {
            updateScores();
            showMessage('ğŸ® Welcome to Taboo! Divide into teams and click "Start Round"!', 'info');
        }
        
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>